<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Setup PIN</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0c0a10;--gold:#d4a853;--rose:#e8836a;--surface:rgba(28,20,40,0.95);--border:rgba(212,168,83,0.2);--text:#f5f0e8;--muted:#7c6e5a;--open:#4ade80;--grad:linear-gradient(135deg,#d4a853,#e8836a)}
body{font-family:'DM Sans',sans-serif;background:var(--bg);min-height:100vh;display:flex;align-items:center;justify-content:center;
  background-image:radial-gradient(ellipse at 30% 40%,rgba(212,168,83,0.07) 0%,transparent 60%),radial-gradient(ellipse at 70% 60%,rgba(74,222,128,0.05) 0%,transparent 50%);padding:20px}
.orb{position:fixed;border-radius:50%;filter:blur(80px);opacity:0.12;pointer-events:none}
.orb1{width:300px;height:300px;background:#4ade80;top:-60px;left:-60px;animation:f1 9s ease-in-out infinite}
.orb2{width:250px;height:250px;background:#d4a853;bottom:-40px;right:-40px;animation:f2 11s ease-in-out infinite}
@keyframes f1{0%,100%{transform:translate(0,0)}50%{transform:translate(20px,20px)}}
@keyframes f2{0%,100%{transform:translate(0,0)}50%{transform:translate(-15px,-15px)}}

.setup-card{
  background:var(--surface);border:1px solid var(--border);border-radius:28px;
  padding:48px 36px;width:100%;max-width:380px;
  backdrop-filter:blur(20px);box-shadow:0 32px 80px rgba(0,0,0,0.5);
  animation:cardIn 0.5s cubic-bezier(0.34,1.56,0.64,1);text-align:center;position:relative;overflow:hidden;
}
@keyframes cardIn{from{opacity:0;transform:scale(0.9)}to{opacity:1;transform:scale(1)}}
.card-shine{position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,rgba(212,168,83,0.5),transparent)}

.step-icon{font-size:48px;margin-bottom:16px}
.step-title{font-family:'Playfair Display',serif;font-size:22px;font-weight:700;margin-bottom:8px}
.step-desc{font-size:13px;color:var(--muted);margin-bottom:32px;line-height:1.6}

.pin-dots{display:flex;justify-content:center;gap:16px;margin-bottom:32px}
.dot{width:18px;height:18px;border-radius:50%;border:2px solid rgba(212,168,83,0.3);background:transparent;transition:all 0.25s cubic-bezier(0.34,1.56,0.64,1)}
.dot.filled{background:var(--grad);border-color:transparent;box-shadow:0 0 12px rgba(212,168,83,0.5);transform:scale(1.1)}
.dot.confirm{background:linear-gradient(135deg,#4ade80,#22d3ee);box-shadow:0 0 12px rgba(74,222,128,0.5)}

.keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;max-width:280px;margin:0 auto}
.key{padding:18px;border-radius:16px;background:rgba(255,255,255,0.04);border:1px solid rgba(255,255,255,0.07);color:var(--text);font-size:20px;font-weight:600;font-family:'DM Sans',sans-serif;cursor:pointer;transition:all 0.15s;display:flex;flex-direction:column;align-items:center;justify-content:center;user-select:none;-webkit-tap-highlight-color:transparent}
.key:hover{background:rgba(212,168,83,0.1);border-color:rgba(212,168,83,0.25);transform:scale(1.03)}
.key:active{transform:scale(0.95);background:rgba(212,168,83,0.2)}
.key-sub{font-size:8px;color:var(--muted);letter-spacing:1px;font-weight:500;margin-top:2px}
.key-del{font-size:16px}
.key-empty{visibility:hidden}

.status-msg{border-radius:10px;padding:11px;font-size:12px;margin-top:16px;display:none}
.status-error{background:rgba(248,113,113,0.1);border:1px solid rgba(248,113,113,0.25);color:#f87171;animation:shake 0.3s ease}
.status-success{background:rgba(74,222,128,0.1);border:1px solid rgba(74,222,128,0.25);color:#4ade80}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}

.progress{display:flex;gap:6px;justify-content:center;margin-bottom:24px}
.progress-dot{width:8px;height:8px;border-radius:50%;background:rgba(212,168,83,0.2);transition:all 0.3s}
.progress-dot.active{background:var(--gold);box-shadow:0 0 8px rgba(212,168,83,0.4)}
</style>
</head>
<body>
<div class="orb orb1"></div>
<div class="orb orb2"></div>

<div class="setup-card">
  <div class="card-shine"></div>

  <div class="progress">
    <div class="progress-dot active" id="p0"></div>
    <div class="progress-dot" id="p1"></div>
  </div>

  <div class="step-icon" id="stepIcon">üîê</div>
  <div class="step-title" id="stepTitle">Create Your PIN</div>
  <div class="step-desc" id="stepDesc">Set a 4-digit PIN to secure your manager account</div>

  <div class="pin-dots" id="pinDots">
    <div class="dot" id="d0"></div>
    <div class="dot" id="d1"></div>
    <div class="dot" id="d2"></div>
    <div class="dot" id="d3"></div>
  </div>

  <div class="keypad">
    <div class="key" onclick="pressKey('1')">1<span class="key-sub"></span></div>
    <div class="key" onclick="pressKey('2')">2<span class="key-sub">ABC</span></div>
    <div class="key" onclick="pressKey('3')">3<span class="key-sub">DEF</span></div>
    <div class="key" onclick="pressKey('4')">4<span class="key-sub">GHI</span></div>
    <div class="key" onclick="pressKey('5')">5<span class="key-sub">JKL</span></div>
    <div class="key" onclick="pressKey('6')">6<span class="key-sub">MNO</span></div>
    <div class="key" onclick="pressKey('7')">7<span class="key-sub">PQRS</span></div>
    <div class="key" onclick="pressKey('8')">8<span class="key-sub">TUV</span></div>
    <div class="key" onclick="pressKey('9')">9<span class="key-sub">WXYZ</span></div>
    <div class="key key-empty"></div>
    <div class="key" onclick="pressKey('0')">0</div>
    <div class="key key-del" onclick="deleteKey()">‚å´</div>
  </div>

  <div class="status-msg" id="statusMsg"></div>
</div>

<script>
if(localStorage.getItem('isLoggedIn')!=='true') window.location.href='index.html';

var firstPin = '';
var currentPin = '';
var confirming = false;

function pressKey(k){
  if(currentPin.length >= 4) return;
  currentPin += k;
  updateDots();
  if(currentPin.length === 4) setTimeout(proceed, 250);
}

function deleteKey(){
  currentPin = currentPin.slice(0,-1);
  updateDots();
}

function updateDots(){
  for(var i=0;i<4;i++){
    var d = document.getElementById('d'+i);
    d.className = 'dot' + (i < currentPin.length ? (confirming?' confirm':' filled') : '');
  }
}

function proceed(){
  if(!confirming){
    firstPin = currentPin;
    currentPin = '';
    confirming = true;
    document.getElementById('stepIcon').textContent = '‚úÖ';
    document.getElementById('stepTitle').textContent = 'Confirm Your PIN';
    document.getElementById('stepDesc').textContent = 'Enter the same PIN again to confirm';
    document.getElementById('p0').classList.remove('active');
    document.getElementById('p1').classList.add('active');
    updateDots();
  } else {
    if(currentPin === firstPin){
      localStorage.setItem('managerPin', currentPin);
      showStatus('PIN set successfully! Redirecting...', 'success');
      setTimeout(function(){ window.location.href='pin-login.html'; }, 1200);
    } else {
      showStatus('PINs do not match. Please try again.', 'error');
      currentPin = '';
      firstPin = '';
      confirming = false;
      setTimeout(function(){
        document.getElementById('stepIcon').textContent = 'üîê';
        document.getElementById('stepTitle').textContent = 'Create Your PIN';
        document.getElementById('stepDesc').textContent = 'Set a 4-digit PIN to secure your manager account';
        document.getElementById('p0').classList.add('active');
        document.getElementById('p1').classList.remove('active');
        updateDots();
      }, 1500);
    }
  }
}

function showStatus(msg, type){
  var el = document.getElementById('statusMsg');
  el.textContent = msg;
  el.className = 'status-msg status-' + type;
  el.style.display = 'block';
  if(type === 'error') setTimeout(function(){el.style.display='none'}, 2000);
}
</script>
</body>
</html>
